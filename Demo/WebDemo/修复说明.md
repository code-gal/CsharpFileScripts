# é—®é¢˜ä¿®å¤è¯´æ˜

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### 1. IPv6 ç›‘å¬é—®é¢˜

**é—®é¢˜**: æœåŠ¡å™¨é»˜è®¤ç›‘å¬ `http://[::]:5000` (IPv6)ï¼Œå¯¼è‡´ `http://localhost:5000` æ— æ³•è®¿é—®

**ä¿®å¤**: 
- æ˜ç¡®é…ç½® Kestrel ç›‘å¬ IPv4 åœ°å€
- ç›‘å¬ `127.0.0.1` (æœ¬åœ°) å’Œ `0.0.0.0` (ç½‘ç»œ)
- ä¸å†ä½¿ç”¨ `ListenAnyIP` (ä¼šç›‘å¬ IPv6)

```csharp
builder.WebHost.ConfigureKestrel(options =>
{
    var port = builder.Configuration.GetValue<int>("Port", 5000);
    options.Listen(IPAddress.Loopback, port); // 127.0.0.1
    options.Listen(IPAddress.Any, port);      // 0.0.0.0
});
```

### 2. JSON åºåˆ—åŒ–é”™è¯¯

**é—®é¢˜**: 
```
System.NotSupportedException: JsonTypeInfo metadata for type '<>f__AnonymousType0`3...' was not provided
```

**åŸå› **: .NET 9+ çš„æœ€å° API éœ€è¦ä¸º JSON åºåˆ—åŒ–é…ç½®ç±»å‹ä¿¡æ¯è§£æå™¨

**ä¿®å¤**: 
- æ·»åŠ  `AppJsonSerializerContext` ç±» (æ”¯æŒæºç”Ÿæˆå’Œ AOT)
- é…ç½® HTTP JSON é€‰é¡¹
- ä½¿ç”¨å¼ºç±»å‹ `record` æ›¿ä»£åŒ¿åç±»å‹

```csharp
// é…ç½® JSON åºåˆ—åŒ–å™¨
builder.Services.ConfigureHttpJsonOptions(options =>
{
    options.SerializerOptions.TypeInfoResolverChain.Insert(0, AppJsonSerializerContext.Default);
});

// JSON ä¸Šä¸‹æ–‡
[JsonSerializable(typeof(HealthResponse))]
[JsonSerializable(typeof(ErrorResponse))]
internal partial class AppJsonSerializerContext : JsonSerializerContext { }

// å¼ºç±»å‹æ¨¡å‹
record HealthResponse(string Status, string Message, DateTime Timestamp);
record ErrorResponse(int Code, string Message, string Path);
```

### 3. æ·»åŠ é…ç½®æ–‡ä»¶æ”¯æŒ

**æ–°å¢æ–‡ä»¶**:

1. **`WebDemo.settings.json`** - åº”ç”¨é…ç½®
```json
{
  "Port": 5000,
  "Host": "localhost",
  "WebRoot": "www",
  "Features": {
    "DirectoryBrowsing": true,
    "DetailedErrors": true
  }
}
```

2. **`WebDemo.run.json`** - è¿è¡Œé…ç½® (å¯åŠ¨é…ç½®æ–‡ä»¶)
```json
{
  "profiles": {
    "WebDemo": {
      "applicationUrl": "http://localhost:5000",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    }
  }
}
```

## ğŸ“‹ æµ‹è¯•æ¸…å•

### è¿è¡Œæµ‹è¯•

```bash
# æ¸…ç†ç¼“å­˜
dotnet clean WebDemo.cs

# é‡æ–°è¿è¡Œ
dotnet run WebDemo.cs
```

### é¢„æœŸè¾“å‡º

```
ğŸ“ Web æ ¹ç›®å½•: C:\...\www
============================================================
ğŸš€ WebDemo Web æœåŠ¡å™¨å·²å¯åŠ¨!
ğŸ“ æœ¬åœ°è®¿é—®: http://localhost:5000
ğŸŒ ç½‘ç»œè®¿é—®: http://MSB:5000
ğŸ“‚ æµè§ˆæ–‡ä»¶: http://localhost:5000/browse
ğŸ’š å¥åº·æ£€æŸ¥: http://localhost:5000/health
============================================================
æŒ‰ Ctrl+C åœæ­¢æœåŠ¡å™¨
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://127.0.0.1:5000
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://0.0.0.0:5000
```

### éªŒè¯ç«¯ç‚¹

âœ… **é¦–é¡µ**: http://localhost:5000  
âœ… **ç¤ºä¾‹é¡µ**: http://localhost:5000/example.html  
âœ… **æ–‡ä»¶æµè§ˆ**: http://localhost:5000/browse  
âœ… **å¥åº·æ£€æŸ¥**: http://localhost:5000/health  

å¥åº·æ£€æŸ¥åº”è¿”å›:
```json
{
  "status": "å¥åº·",
  "message": "WebDemo æ­£åœ¨è¿è¡Œ",
  "timestamp": "2024-01-15T10:30:00"
}
```

## ğŸ¯ ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼

æ‰€æœ‰é—®é¢˜å·²ä¿®å¤ï¼ŒæœåŠ¡å™¨ç°åœ¨åº”è¯¥å¯ä»¥åœ¨ `http://localhost:5000` æ­£å¸¸è®¿é—®ï¼
